--BEGIN
  --dbms_snapshot.REFRESH('C_CN_EXCLUSIONS');
--END;

CREATE MATERIALIZED VIEW LOG ON H_CN_ACTIVITIES_STUDENT;

CREATE MATERIALIZED VIEW C_CN_ACTIVITIES_STUDENT refresh FAST ON demand
AS
  SELECT PIDM
  , BANNER_ID
  , NAME_SORT
  , ENTITY_CODE
  , RECORD_START_DATE
  , ACTC_021
  , ACTC_022
  , ACTC_024
  , ACTC_025
  , ACTC_04A
  , ACTC_0501
  , ACTC_0502
  , ACTC_0503
  , ACTC_0511
  , ACTC_0512
  , ACTC_0513
  , ACTC_0521
  , ACTC_0522
  , ACTC_0523
  , ACTC_0531
  , ACTC_0532
  , ACTC_0533
  , ACTC_0541
  , ACTC_0542
  , ACTC_0543
  , ACTC_0551
  , ACTC_0552
  , ACTC_0553
  , ACTC_059
  , ACTC_0611
  , ACTC_0612
  , ACTC_0613
  , ACTC_064A1
  , ACTC_064A2
  , ACTC_064A3
  , ACTC_064A4
  , ACTC_064B1
  , ACTC_064B2
  , ACTC_064B3
  , ACTC_064B4
  , ACTC_065A1
  , ACTC_065A2
  , ACTC_065A4
  , ACTC_065B1
  , ACTC_065B2
  , ACTC_065B3
  , ACTC_065B4
  , ACTC_065B5
  , ACTC_065C1
  , ACTC_065C2
  , ACTC_065C3
  , ACTC_065C4
  , ACTC_065D1
  , ACTC_065D2
  , ACTC_065D3
  , ACTC_065D4
  , ACTC_066A1
  , ACTC_066A2
  , ACTC_066A3
  , ACTC_066A4
  , ACTC_066B1
  , ACTC_066B2
  , ACTC_066B3
  , ACTC_066B4
  , ACTC_067A1
  , ACTC_067A2
  , ACTC_067A3
  , ACTC_067B1
  , ACTC_067B2
  , ACTC_067B3
  , ACTC_068A1
  , ACTC_068A2
  , ACTC_068A3
  , ACTC_068B1
  , ACTC_068B2
  , ACTC_068B3
  , ACTC_068C1
  , ACTC_068C2
  , ACTC_068C3
  , ACTC_06A
  , ACTC_071
  , ACTC_10
  , ACTC_102
  , ACTC_109A
  , ACTC_109B
  , ACTC_109C
  , ACTC_11
  , ACTC_12
  , ACTC_13
  , ACTC_137
  , ACTC_14
  , ACTC_140
  , ACTC_14A
  , ACTC_14B
  , ACTC_14C
  , ACTC_14D
  , ACTC_14E
  , ACTC_14F
  , ACTC_15
  , ACTC_16
  , ACTC_17
  , ACTC_18
  , ACTC_19
  , ACTC_192
  , ACTC_193
  , ACTC_196
  , ACTC_20
  , ACTC_2011
  , ACTC_2012
  , ACTC_2013
  , ACTC_2014
  , ACTC_2015
  , ACTC_2016
  , ACTC_20A
  , ACTC_22
  , ACTC_23
  , ACTC_24
  , ACTC_25
  , ACTC_25A
  , ACTC_26A
  , ACTC_26B
  , ACTC_26C
  , ACTC_30A
  , ACTC_31A
  , ACTC_32A
  , ACTC_33A
  , ACTC_34A
  , ACTC_99A
  , ACTC_99B
  , ACTC_ACEN
  , ACTC_ACH
  , ACTC_ACHI
  , ACTC_ACM
  , ACTC_ACRO
  , ACTC_ACS
  , ACTC_AEA
  , ACTC_AED
  , ACTC_AEP
  , ACTC_AF
  , ACTC_AFC
  , ACTC_AGD
  , ACTC_AGDC
  , ACTC_AHO
  , ACTC_AIAS
  , ACTC_AIC
  , ACTC_AIK
  , ACTC_AKP
  , ACTC_ALO
  , ACTC_ALT
  , ACTC_ALURT
  , ACTC_AMA
  , ACTC_AMB
  , ACTC_AMM
  , ACTC_AMN
  , ACTC_AMRAD
  , ACTC_AOP
  , ACTC_APA
  , ACTC_APH
  , ACTC_APO
  , ACTC_AR
  , ACTC_ARC
  , ACTC_ASA
  , ACTC_ASAL
  , ACTC_ASC
  , ACTC_ASM
  , ACTC_ASP
  , ACTC_AST
  , ACTC_AT
  , ACTC_ATC
  , ACTC_ATO
  , ACTC_AWR
  , ACTC_AWS
  , ACTC_BAC
  , ACTC_BADC
  , ACTC_BBC
  , ACTC_BEA
  , ACTC_BEB
  , ACTC_BEC
  , ACTC_BHA
  , ACTC_BIE
  , ACTC_BIGBRO
  , ACTC_BME
  , ACTC_BOL
  , ACTC_BOXING
  , ACTC_BRASS
  , ACTC_BRIDGE
  , ACTC_BSU
  , ACTC_BTP
  , ACTC_BTPC
  , ACTC_BTS
  , ACTC_BUE
  , ACTC_CAC
  , ACTC_CANT
  , ACTC_CCAB
  , ACTC_CCC
  , ACTC_CCF
  , ACTC_CEG
  , ACTC_CENT
  , ACTC_CFS
  , ACTC_CHA
  , ACTC_CHE
  , ACTC_CHIDEL
  , ACTC_CHO
  , ACTC_CHS
  , ACTC_CKI
  , ACTC_CKT
  , ACTC_COACH
  , ACTC_COB
  , ACTC_COD
  , ACTC_CODEN
  , ACTC_CON
  , ACTC_COR
  , ACTC_COSMO
  , ACTC_CPH
  , ACTC_CPS
  , ACTC_CRM
  , ACTC_CRW
  , ACTC_CSC
  , ACTC_CSS
  , ACTC_CUT
  , ACTC_CYAN
  , ACTC_CYCLE
  , ACTC_DAN
  , ACTC_DARE
  , ACTC_DAT
  , ACTC_DBF
  , ACTC_DCH
  , ACTC_DEB
  , ACTC_DEC
  , ACTC_DEN
  , ACTC_DES
  , ACTC_DGA
  , ACTC_DGY
  , ACTC_DIMEN
  , ACTC_DIV
  , ACTC_DPH
  , ACTC_DSC
  , ACTC_DSP
  , ACTC_DSR
  , ACTC_DTD
  , ACTC_DUP
  , ACTC_DWS
  , ACTC_DZE
  , ACTC_EAS
  , ACTC_ECH
  , ACTC_ECS
  , ACTC_EES
  , ACTC_EKN
  , ACTC_EMS
  , ACTC_EQU
  , ACTC_ESL
  , ACTC_EWB
  , ACTC_EXO
  , ACTC_FAS
  , ACTC_FBLA
  , ACTC_FCA
  , ACTC_FCC
  , ACTC_FER
  , ACTC_FGE
  , ACTC_FHC
  , ACTC_FIN
  , ACTC_FLM
  , ACTC_FLP
  , ACTC_FMA
  , ACTC_FMCG
  , ACTC_FMEM
  , ACTC_FMSM
  , ACTC_FON
  , ACTC_FOR
  , ACTC_FORUM
  , ACTC_FOT
  , ACTC_FRE
  , ACTC_FRI
  , ACTC_FTA
  , ACTC_FTAA
  , ACTC_FTB
  , ACTC_FTC
  , ACTC_FTD
  , ACTC_FTE
  , ACTC_GAM
  , ACTC_GER
  , ACTC_GERMAN
  , ACTC_GLA
  , ACTC_GOL
  , ACTC_GOS
  , ACTC_GPB
  , ACTC_GRC
  , ACTC_GSC
  , ACTC_GUP
  , ACTC_GVG
  , ACTC_GYM
  , ACTC_HALL
  , ACTC_HAWK
  , ACTC_HBI
  , ACTC_HEH
  , ACTC_HEL
  , ACTC_HHC
  , ACTC_HIL
  , ACTC_HIS
  , ACTC_IBC
  , ACTC_ICA
  , ACTC_ICARE
  , ACTC_ICB
  , ACTC_ICC
  , ACTC_ICG
  , ACTC_ICR
  , ACTC_IDC
  , ACTC_IEE
  , ACTC_IFA
  , ACTC_IFC
  , ACTC_IFCC
  , ACTC_IHW
  , ACTC_IIE
  , ACTC_IM4
  , ACTC_IMB
  , ACTC_IMD
  , ACTC_IMF
  , ACTC_IMG
  , ACTC_IMI
  , ACTC_IMM
  , ACTC_IMP
  , ACTC_IMS
  , ACTC_IMT
  , ACTC_IMV
  , ACTC_IMW
  , ACTC_INC
  , ACTC_INR
  , ACTC_INTERN
  , ACTC_INTFC
  , ACTC_INV
  , ACTC_IOP
  , ACTC_IPD
  , ACTC_ISA
  , ACTC_ISC
  , ACTC_ITP
  , ACTC_JAZ
  , ACTC_KAD
  , ACTC_KAL
  , ACTC_KAP
  , ACTC_KAR
  , ACTC_KAT
  , ACTC_KSA
  , ACTC_KSC
  , ACTC_KSI
  , ACTC_LAW
  , ACTC_LAX
  , ACTC_LBF
  , ACTC_LCA
  , ACTC_LCF
  , ACTC_LDST
  , ACTC_LEA
  , ACTC_LFL
  , ACTC_LLD
  , ACTC_LLE
  , ACTC_LMC
  , ACTC_LPO
  , ACTC_LRE
  , ACTC_LSH
  , ACTC_LSU
  , ACTC_LSVS
  , ACTC_LTA
  , ACTC_LTV
  , ACTC_LUEM
  , ACTC_LUF
  , ACTC_LUFA
  , ACTC_LUM
  , ACTC_LUV
  , ACTC_LUVME
  , ACTC_LVM
  , ACTC_LVR
  , ACTC_LVS
  , ACTC_LWC
  , ACTC_MAC
  , ACTC_MANG
  , ACTC_MAR
  , ACTC_MARL
  , ACTC_MARM
  , ACTC_MARS
  , ACTC_MBA
  , ACTC_MBB
  , ACTC_MBC
  , ACTC_MCC
  , ACTC_MCH
  , ACTC_MCR
  , ACTC_MCS
  , ACTC_MDS
  , ACTC_MEI
  , ACTC_MFB
  , ACTC_MFE
  , ACTC_MGO
  , ACTC_MIH
  , ACTC_MKT
  , ACTC_MLA
  , ACTC_MOS
  , ACTC_MRI
  , ACTC_MSA
  , ACTC_MSK
  , ACTC_MSO
  , ACTC_MSQ
  , ACTC_MSU
  , ACTC_MSW
  , ACTC_MTE
  , ACTC_MTI
  , ACTC_MTO
  , ACTC_MUS
  , ACTC_MVB
  , ACTC_MWP
  , ACTC_MWR
  , ACTC_NAV
  , ACTC_NCI
  , ACTC_NCS
  , ACTC_NEW
  , ACTC_NSB
  , ACTC_OAP
  , ACTC_OCF
  , ACTC_OCTO
  , ACTC_ODE
  , ACTC_OFYL
  , ACTC_OOM
  , ACTC_OPP
  , ACTC_ORC
  , ACTC_ORI
  , ACTC_OTM
  , ACTC_OUT
  , ACTC_PAN
  , ACTC_PAT
  , ACTC_PBC
  , ACTC_PBP
  , ACTC_PCR
  , ACTC_PDE
  , ACTC_PDT
  , ACTC_PEP
  , ACTC_PGD
  , ACTC_PHI
  , ACTC_PHOTO
  , ACTC_PIN
  , ACTC_PKA
  , ACTC_PKP
  , ACTC_PKT
  , ACTC_PLP
  , ACTC_PME
  , ACTC_PRH
  , ACTC_PRIDE
  , ACTC_PRS
  , ACTC_PRSC
  , ACTC_PRSSA
  , ACTC_PSA
  , ACTC_PSK
  , ACTC_PSP
  , ACTC_PSR
  , ACTC_PUP
  , ACTC_RACQUET
  , ACTC_RAG
  , ACTC_RAN
  , ACTC_RHA
  , ACTC_RHC
  , ACTC_RIF
  , ACTC_ROD
  , ACTC_ROH
  , ACTC_RSF
  , ACTC_RUM
  , ACTC_RUN
  , ACTC_RUSS
  , ACTC_RUW
  , ACTC_SAC
  , ACTC_SADD
  , ACTC_SAE
  , ACTC_SAIL
  , ACTC_SALSA
  , ACTC_SAMU
  , ACTC_SAMUC
  , ACTC_SAO
  , ACTC_SAY
  , ACTC_SAZ
  , ACTC_SBA
  , ACTC_SBB
  , ACTC_SBC
  , ACTC_SBD
  , ACTC_SBDEIC
  , ACTC_SBE
  , ACTC_SBF
  , ACTC_SBG
  , ACTC_SBH
  , ACTC_SBI
  , ACTC_SBK
  , ACTC_SBL
  , ACTC_SBO
  , ACTC_SCC
  , ACTC_SCG
  , ACTC_SCHI
  , ACTC_SCHIC
  , ACTC_SCI
  , ACTC_SCJ
  , ACTC_SCK
  , ACTC_SCKC
  , ACTC_SCM
  , ACTC_SCO
  , ACTC_SCT
  , ACTC_SDA
  , ACTC_SDB
  , ACTC_SDD
  , ACTC_SEA
  , ACTC_SEN
  , ACTC_SEX
  , ACTC_SGR
  , ACTC_SHB
  , ACTC_SHD
  , ACTC_SHH
  , ACTC_SHP
  , ACTC_SJC
  , ACTC_SJR
  , ACTC_SJZ
  , ACTC_SKC
  , ACTC_SKT
  , ACTC_SME
  , ACTC_SMN
  , ACTC_SMS
  , ACTC_SNC
  , ACTC_SNU
  , ACTC_SOCM
  , ACTC_SOCW
  , ACTC_SORLIA
  , ACTC_SOUM
  , ACTC_SPC
  , ACTC_SPE
  , ACTC_SPHE
  , ACTC_SPI
  , ACTC_SPM
  , ACTC_SPS
  , ACTC_SRW
  , ACTC_SSA
  , ACTC_SSD
  , ACTC_SSP
  , ACTC_STA
  , ACTC_STAGE
  , ACTC_STAR
  , ACTC_STEM
  , ACTC_STHOCKEY
  , ACTC_STHPR
  , ACTC_SWC
  , ACTC_SWCL
  , ACTC_SWE
  , ACTC_SXP
  , ACTC_T05
  , ACTC_T07
  , ACTC_T08
  , ACTC_T09
  , ACTC_TAE
  , ACTC_TAGAR
  , ACTC_TAL
  , ACTC_TAR
  , ACTC_TCH
  , ACTC_TDC
  , ACTC_TDCC
  , ACTC_TDP
  , ACTC_TEN
  , ACTC_TEP
  , ACTC_TKD
  , ACTC_TKP
  , ACTC_TOWN
  , ACTC_TPC
  , ACTC_TRAC
  , ACTC_TUS
  , ACTC_TXI
  , ACTC_TXIC
  , ACTC_UMOJA
  , ACTC_UNC
  , ACTC_UPBEAT
  , ACTC_UPS
  , ACTC_VAWSS
  , ACTC_VDAY
  , ACTC_VIS
  , ACTC_VMP
  , ACTC_VOM
  , ACTC_VOX
  , ACTC_VRC
  , ACTC_WAC
  , ACTC_WAR
  , ACTC_WBB
  , ACTC_WBC
  , ACTC_WBM
  , ACTC_WBO
  , ACTC_WCA
  , ACTC_WCC
  , ACTC_WCL
  , ACTC_WCR
  , ACTC_WCSTAFF
  , ACTC_WFE
  , ACTC_WFH
  , ACTC_WGO
  , ACTC_WGY
  , ACTC_WIB
  , ACTC_WIH
  , ACTC_WIND
  , ACTC_WKRP
  , ACTC_WLA
  , ACTC_WLTN
  , ACTC_WLVR
  , ACTC_WOS
  , ACTC_WPC
  , ACTC_WRE
  , ACTC_WSB
  , ACTC_WSK
  , ACTC_WSO
  , ACTC_WSQ
  , ACTC_WSS
  , ACTC_WSW
  , ACTC_WTE
  , ACTC_WTH
  , ACTC_WTI
  , ACTC_WTO
  , ACTC_WVB
  , ACTC_WVC
  , ACTC_WWD
  , ACTC_WWP
  , ACTC_ZPS
  , ACTC_ZTA
  , ACTC_21
  , ACTC_FEM
  , ACTC_GLOBE
  FROM h_cn_activities_student
  WHERE record_end_date IS NULL; 
  
  CREATE INDEX C_CN_ACTIVITIES_STUDENT_IDX ON C_CN_ACTIVITIES_STUDENT (PIDM);
  CREATE INDEX C_CN_ACTIVITIES_STUDENT_START ON C_CN_ACTIVITIES_STUDENT (PIDM, RECORD_START_DATE);
  CREATE INDEX C_CN_ACTIVITIES_STUD_BANNER_ID ON C_CN_ACTIVITIES_STUDENT (BANNER_ID);
  CREATE INDEX C_CN_ACTIVITIES_STUD_NAME_SORT ON C_CN_ACTIVITIES_STUDENT (NAME_SORT);
  CREATE INDEX C_CN_ACTIVITIES_STUD_ENTITY ON C_CN_ACTIVITIES_STUDENT (ENTITY_CODE);
