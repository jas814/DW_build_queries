--BEGIN
--  dbms_snapshot.REFRESH('c_cn_education_lu_by_id');
--END;

CREATE MATERIALIZED VIEW LOG ON H_CN_EDUCATION_LU_BY_ID;

CREATE MATERIALIZED VIEW C_CN_EDUCATION_LU_BY_ID refresh FAST ON demand
AS
  SELECT PIDM
  , BANNER_ID
  , NAME_SORT
  , ENTITY_CODE
  , RECORD_START_DATE
  , D1_EDUC_SEQNO
  , D1_DEGREE_CODE
  , D1_DEGREE_DESC
  , D1_DEGREE_DATE
  , D1_COLLEGE_CODE
  , D1_COLLEGE_DESC
  , D1_ACTIVITY_DATE
  , D1_DEGREE_YEAR
  , D1_CAMPUS_CODE
  , D1_CAMPUS_DESC
  , D1_DEPT_CODE_1
  , D1_DEPT_DESC_1
  , D1_DEPT_CODE_2
  , D1_DEPT_DESC_2
  , D1_COMMENTS
  , D1_MAJOR_COMMENT
  , D1_MAJOR_CODE_1
  , D1_MAJOR_DESC_1
  , D1_MAJOR_CODE_2
  , D1_MAJOR_DESC_2
  , D1_MAJOR_CODE_3
  , D1_MAJOR_DESC_3
  , D1_MAJOR_CODE_4
  , D1_MAJOR_DESC_4
  , D1_MAJR_CODE_MINR_1
  , D1_MINOR_DESC_1
  , D1_MAJR_CODE_MINR_2
  , D1_MINOR_DESC_2
  , D1_MAJR_CODE_CONC_1
  , D1_CONC_DESC_1
  , D1_MAJR_CODE_CONC_2
  , D1_CONC_DESC_2
  , D1_MAJR_CODE_CONC_3
  , D1_CONC_DESC_3
  , D1_HONR_CODE_1
  , D1_HONR_DESC_1
  , D1_HONR_CODE_2
  , D1_HONR_DESC_2
  , D1_HONR_CODE_3
  , D1_HONR_DESC_3
  , D1_HONR_CODE_4
  , D1_HONR_DESC_4
  , D1_HOND_CODE_1
  , D1_HOND_DESC_1
  , D1_HOND_CODE_2
  , D1_HOND_DESC_2
  , D1_HOND_CODE_3
  , D1_HOND_DESC_3
  , D1_HOND_CODE_4
  , D1_HOND_DESC_4
  , D2_EDUC_SEQNO
  , D2_DEGREE_CODE
  , D2_DEGREE_DESC
  , D2_DEGREE_DATE
  , D2_COLLEGE_CODE
  , D2_COLLEGE_DESC
  , D2_ACTIVITY_DATE
  , D2_DEGREE_YEAR
  , D2_CAMPUS_CODE
  , D2_CAMPUS_DESC
  , D2_DEPT_CODE_1
  , D2_DEPT_DESC_1
  , D2_DEPT_CODE_2
  , D2_DEPT_DESC_2
  , D2_COMMENTS
  , D2_MAJOR_COMMENT
  , D2_MAJOR_CODE_1
  , D2_MAJOR_DESC_1
  , D2_MAJOR_CODE_2
  , D2_MAJOR_DESC_2
  , D2_MAJOR_CODE_3
  , D2_MAJOR_DESC_3
  , D2_MAJOR_CODE_4
  , D2_MAJOR_DESC_4
  , D2_MAJR_CODE_MINR_1
  , D2_MINOR_DESC_1
  , D2_MAJR_CODE_MINR_2
  , D2_MINOR_DESC_2
  , D2_MAJR_CODE_CONC_1
  , D2_CONC_DESC_1
  , D2_MAJR_CODE_CONC_2
  , D2_CONC_DESC_2
  , D2_MAJR_CODE_CONC_3
  , D2_CONC_DESC_3
  , D2_HONR_CODE_1
  , D2_HONR_DESC_1
  , D2_HONR_CODE_2
  , D2_HONR_DESC_2
  , D2_HONR_CODE_3
  , D2_HONR_DESC_3
  , D2_HONR_CODE_4
  , D2_HONR_DESC_4
  , D2_HOND_CODE_1
  , D2_HOND_DESC_1
  , D2_HOND_CODE_2
  , D2_HOND_DESC_2
  , D2_HOND_CODE_3
  , D2_HOND_DESC_3
  , D2_HOND_CODE_4
  , D2_HOND_DESC_4
  , D3_EDUC_SEQNO
  , D3_DEGREE_CODE
  , D3_DEGREE_DESC
  , D3_DEGREE_DATE
  , D3_COLLEGE_CODE
  , D3_COLLEGE_DESC
  , D3_ACTIVITY_DATE
  , D3_DEGREE_YEAR
  , D3_CAMPUS_CODE
  , D3_CAMPUS_DESC
  , D3_DEPT_CODE_1
  , D3_DEPT_DESC_1
  , D3_DEPT_CODE_2
  , D3_DEPT_DESC_2
  , D3_COMMENTS
  , D3_MAJOR_COMMENT
  , D3_MAJOR_CODE_1
  , D3_MAJOR_DESC_1
  , D3_MAJOR_CODE_2
  , D3_MAJOR_DESC_2
  , D3_MAJOR_CODE_3
  , D3_MAJOR_DESC_3
  , D3_MAJOR_CODE_4
  , D3_MAJOR_DESC_4
  , D3_MAJR_CODE_MINR_1
  , D3_MINOR_DESC_1
  , D3_MAJR_CODE_MINR_2
  , D3_MINOR_DESC_2
  , D3_MAJR_CODE_CONC_1
  , D3_CONC_DESC_1
  , D3_MAJR_CODE_CONC_2
  , D3_CONC_DESC_2
  , D3_MAJR_CODE_CONC_3
  , D3_CONC_DESC_3
  , D3_HONR_CODE_1
  , D3_HONR_DESC_1
  , D3_HONR_CODE_2
  , D3_HONR_DESC_2
  , D3_HONR_CODE_3
  , D3_HONR_DESC_3
  , D3_HONR_CODE_4
  , D3_HONR_DESC_4
  , D3_HOND_CODE_1
  , D3_HOND_DESC_1
  , D3_HOND_CODE_2
  , D3_HOND_DESC_2
  , D3_HOND_CODE_3
  , D3_HOND_DESC_3
  , D3_HOND_CODE_4
  , D3_HOND_DESC_4
  , D4_EDUC_SEQNO
  , D4_DEGREE_CODE
  , D4_DEGREE_DESC
  , D4_DEGREE_DATE
  , D4_COLLEGE_CODE
  , D4_COLLEGE_DESC
  , D4_ACTIVITY_DATE
  , D4_DEGREE_YEAR
  , D4_CAMPUS_CODE
  , D4_CAMPUS_DESC
  , D4_DEPT_CODE_1
  , D4_DEPT_DESC_1
  , D4_DEPT_CODE_2
  , D4_DEPT_DESC_2
  , D4_COMMENTS
  , D4_MAJOR_COMMENT
  , D4_MAJOR_CODE_1
  , D4_MAJOR_DESC_1
  , D4_MAJOR_CODE_2
  , D4_MAJOR_DESC_2
  , D4_MAJOR_CODE_3
  , D4_MAJOR_DESC_3
  , D4_MAJOR_CODE_4
  , D4_MAJOR_DESC_4
  , D4_MAJR_CODE_MINR_1
  , D4_MINOR_DESC_1
  , D4_MAJR_CODE_MINR_2
  , D4_MINOR_DESC_2
  , D4_MAJR_CODE_CONC_1
  , D4_CONC_DESC_1
  , D4_MAJR_CODE_CONC_2
  , D4_CONC_DESC_2
  , D4_MAJR_CODE_CONC_3
  , D4_CONC_DESC_3
  , D4_HONR_CODE_1
  , D4_HONR_DESC_1
  , D4_HONR_CODE_2
  , D4_HONR_DESC_2
  , D4_HONR_CODE_3
  , D4_HONR_DESC_3
  , D4_HONR_CODE_4
  , D4_HONR_DESC_4
  , D4_HOND_CODE_1
  , D4_HOND_DESC_1
  , D4_HOND_CODE_2
  , D4_HOND_DESC_2
  , D4_HOND_CODE_3
  , D4_HOND_DESC_3
  , D4_HOND_CODE_4
  , D4_HOND_DESC_4
  , D5_EDUC_SEQNO
  , D5_DEGREE_CODE
  , D5_DEGREE_DESC
  , D5_DEGREE_DATE
  , D5_COLLEGE_CODE
  , D5_COLLEGE_DESC
  , D5_ACTIVITY_DATE
  , D5_DEGREE_YEAR
  , D5_CAMPUS_CODE
  , D5_CAMPUS_DESC
  , D5_DEPT_CODE_1
  , D5_DEPT_DESC_1
  , D5_DEPT_CODE_2
  , D5_DEPT_DESC_2
  , D5_COMMENTS
  , D5_MAJOR_COMMENT
  , D5_MAJOR_CODE_1
  , D5_MAJOR_DESC_1
  , D5_MAJOR_CODE_2
  , D5_MAJOR_DESC_2
  , D5_MAJOR_CODE_3
  , D5_MAJOR_DESC_3
  , D5_MAJOR_CODE_4
  , D5_MAJOR_DESC_4
  , D5_MAJR_CODE_MINR_1
  , D5_MINOR_DESC_1
  , D5_MAJR_CODE_MINR_2
  , D5_MINOR_DESC_2
  , D5_MAJR_CODE_CONC_1
  , D5_CONC_DESC_1
  , D5_MAJR_CODE_CONC_2
  , D5_CONC_DESC_2
  , D5_MAJR_CODE_CONC_3
  , D5_CONC_DESC_3
  , D5_HONR_CODE_1
  , D5_HONR_DESC_1
  , D5_HONR_CODE_2
  , D5_HONR_DESC_2
  , D5_HONR_CODE_3
  , D5_HONR_DESC_3
  , D5_HONR_CODE_4
  , D5_HONR_DESC_4
  , D5_HOND_CODE_1
  , D5_HOND_DESC_1
  , D5_HOND_CODE_2
  , D5_HOND_DESC_2
  , D5_HOND_CODE_3
  , D5_HOND_DESC_3
  , D5_HOND_CODE_4
  , D5_HOND_DESC_4
  , D6_EDUC_SEQNO
  , D6_DEGREE_CODE
  , D6_DEGREE_DESC
  , D6_DEGREE_DATE
  , D6_COLLEGE_CODE
  , D6_COLLEGE_DESC
  , D6_ACTIVITY_DATE
  , D6_DEGREE_YEAR
  , D6_CAMPUS_CODE
  , D6_CAMPUS_DESC
  , D6_DEPT_CODE_1
  , D6_DEPT_DESC_1
  , D6_DEPT_CODE_2
  , D6_DEPT_DESC_2
  , D6_COMMENTS
  , D6_MAJOR_COMMENT
  , D6_MAJOR_CODE_1
  , D6_MAJOR_DESC_1
  , D6_MAJOR_CODE_2
  , D6_MAJOR_DESC_2
  , D6_MAJOR_CODE_3
  , D6_MAJOR_DESC_3
  , D6_MAJOR_CODE_4
  , D6_MAJOR_DESC_4
  , D6_MAJR_CODE_MINR_1
  , D6_MINOR_DESC_1
  , D6_MAJR_CODE_MINR_2
  , D6_MINOR_DESC_2
  , D6_MAJR_CODE_CONC_1
  , D6_CONC_DESC_1
  , D6_MAJR_CODE_CONC_2
  , D6_CONC_DESC_2
  , D6_MAJR_CODE_CONC_3
  , D6_CONC_DESC_3
  , D6_HONR_CODE_1
  , D6_HONR_DESC_1
  , D6_HONR_CODE_2
  , D6_HONR_DESC_2
  , D6_HONR_CODE_3
  , D6_HONR_DESC_3
  , D6_HONR_CODE_4
  , D6_HONR_DESC_4
  , D6_HOND_CODE_1
  , D6_HOND_DESC_1
  , D6_HOND_CODE_2
  , D6_HOND_DESC_2
  , D6_HOND_CODE_3
  , D6_HOND_DESC_3
  , D6_HOND_CODE_4
  , D6_HOND_DESC_4
  FROM h_cn_education_lu_by_id
  WHERE record_end_date IS NULL;

  CREATE INDEX C_CN_EDUCATION_LU_BY_ID_IDX ON C_CN_EDUCATION_LU_BY_ID (PIDM) ;
  CREATE INDEX C_CN_EDUCATION_LU_START_DATE ON C_CN_EDUCATION_LU_BY_ID (PIDM, RECORD_START_DATE) ;
